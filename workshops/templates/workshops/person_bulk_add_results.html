{% extends "workshops/_page.html" %}

{% load breadcrumbs %}
{% block breadcrumbs %}
    {% breadcrumb_url 'Index' 'index'  %}
    {% breadcrumb_url 'All persons' 'all_persons' %}
    {% breadcrumb_active 'Process CSV File'  %}
{% endblock %}

{% block content %}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<!--<div class="alert alert-info" role="alert">
<strong>Hint:</strong> you can edit values by double-clicking in the table cells
</div>-->

<table class="table table-striped">
    <tr>
        <th>personal</th>
        <th>middle</th>
        <th>family</th>
        <th>email</th>
        <th>event</th>
        <th>role</th>
        <th>errors</th>
    </tr>
    {% for entry in persons_tasks %}
    <tr>
        <td>{{ entry.person.personal }}</td>
        <td>{{ entry.person.middle }}</td>
        <td>{{ entry.person.family }}</td>
        <td>{{ entry.person.email }}</td>
        <td>{{ entry.event|default_if_none:"&mdash;" }}</td>
        <td>{{ entry.role|default_if_none:"&mdash;" }}</td>
        <td>
        {% if entry.errors %}
            <ul>
            {% for error in entry.errors %}
                <li>{{ error }}</li>
            {% endfor %}
            </ul>
        {% else %}
            {{ entry.errors|default_if_none:"&mdash;" }}
        {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

<form method="POST">
    {% comment %}
    This feels a little bit like cheating, but I don't have any better idea
    how to distinguish between confirmation and cancelation.
    The important implication of this approach is that the fields' names must
    stay the way they're now: "confirm" and "cancel".  Values can change.
    {% endcomment %}
    <input type="submit" name="confirm" value="Confirm and save" class="btn btn-success">
    <input type="submit" name="cancel" value="No, cancel" class="btn btn-default">
    <input type="submit" name="verify" value="Verify" class="btn btn-default pull-right">
    {% csrf_token %}
</form>

{% endblock %}
